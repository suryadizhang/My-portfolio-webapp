#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "🚀 Running pre-push validation..."

# Run type checking, linting, and tests
echo "📋 Step 1/3: Type checking, linting, and tests..."
npm run check || exit 1

# Run module sanity check
echo "📦 Step 2/3: Module sanity check..."
node -e "require.resolve('@portfolio/ui'); require.resolve('@portfolio/utils')" || exit 1

# Optional: Docker smoke test (comment out if Docker Desktop not always running)
echo "🐳 Step 3/3: Docker smoke test..."
npm run docker:smoke || exit 1

echo "✅ All pre-push checks passed! Pushing to remote..."